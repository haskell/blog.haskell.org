
<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="https://blog.haskell.org/abridge.css?h=d58d95c5efe846728d7b" />
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="base" content="https://blog.haskell.org" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#333333" />
  <meta name="msapplication-TileColor" content="#333333" />
  <link rel="manifest" href="https://blog.haskell.org/manifest.min.json" />
  <link rel="mask-icon" href="https://blog.haskell.org/safari-pinned-tab.svg" color="#ff9900" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://blog.haskell.org/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://blog.haskell.org/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://blog.haskell.org/favicon-16x16.png" />
  <link rel="preload" as="font" href="https://blog.haskell.org/fonts/source-sans-3-v9-latin-regular.woff2" type="font/woff2" />
  <link rel="preload" as="font" href="https://blog.haskell.org/fonts/ubuntu-mono-v15-latin-regular.woff2" type="font/woff2" />
  <link rel="preload" as="font" href="https://blog.haskell.org/fonts/raleway-v28-latin-700.woff2" type="font/woff2" />
  <link rel="preload" as="font" href="https://blog.haskell.org/fonts/raleway-v28-latin-900.woff2" type="font/woff2" />
  <link rel="alternate" type="application/atom+xml" title="The Haskell Programming Language&#x27;s blog Atom Feed" href="https://blog.haskell.org/atom.xml" />
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <title>Case Study — Using a JavaScript component inside a Haskell application | The Haskell Programming Language's blog</title>
  <meta name="author" content="Haskell.org" />
  <meta name="copyright" content="The Haskell Programming Language&#x27;s blog" />
  <meta name="description" content="" />
  <link rel="canonical" href="https://blog.haskell.org/case-study-foreign-integration-js-browser/" />
  <meta name="keywords" content="haskell, functional programming, blog" />
  <meta property="og:url" content="https://blog.haskell.org/case-study-foreign-integration-js-browser/" />
  <meta name="twitter:url" content="https://blog.haskell.org/case-study-foreign-integration-js-browser/" />
  <meta property="og:description" content="" />
  <meta name="twitter:description" content="" />
  <meta property="og:title" content="Case Study — Using a JavaScript component inside a Haskell application | The Haskell Programming Language&#x27;s blog" />
  <meta name="twitter:title" content="Case Study — Using a JavaScript component inside a Haskell application | The Haskell Programming Language&#x27;s blog" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://blog.haskell.org/images/haskell-opengraph.png" />
  <meta property="og:image" content="https://blog.haskell.org/images/haskell-opengraph.png" />
  <meta property="og:site_name" content="The Haskell Programming Language&#x27;s blog" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:updated_time" content="2025-01-08" />
  <script defer src="https://blog.haskell.org/js/abridge_nopwa.min.js?h=ad4669e842ae3b93e75c" integrity="sha384-L4qoD2LcUENkFpAPfhagH/avO0pb3xrSkp/zN5WETOjsol+2Kjx8eolYercZ3Z5k"></script>
  <noscript><link rel="stylesheet" href="https://blog.haskell.org/nojs.css" /></noscript>
</head>
<body>
  <header>
    <nav>
      <div><h1><a href="https://blog.haskell.org" title="The Haskell Programming Language&#x27;s blog"><img src="https://blog.haskell.org/images/haskell.svg" alt="Haskell" width="40" height="28" />Haskell Blog</a></h1></div>
      <div>

        <div>
          <ul><li><a class="s110" href="https:&#x2F;&#x2F;haskell.org"> Haskell </a></li><li><a class="s110" href="https://blog.haskell.org/archive/"> Posts </a></li><li><a class="s110" href="https://blog.haskell.org/categories/"> Categories </a></li><li><a class="s110" href="https://blog.haskell.org/about/"> About </a></li></ul>
        </div>

        <div>
          <div>
            <form autocomplete=off class="js" name="goSearch" id="searchbox">
              <div class="searchd">
                <input id="searchinput" type="text" placeholder="Search" title="Search" />
                <button type="submit" title="Search" class="svgs svgm search"></button>
              </div>
              <div class="results"><div id="suggestions"></div></div>
            </form>
          </div>
        </div>

      </div>
    </nav>
  </header>
  <main>
    <article>
      <h1><a href="https://blog.haskell.org/case-study-foreign-integration-js-browser/">Case Study — Using a JavaScript component inside a Haskell application</a></h1>

      <span class="s95">
          <a href="https://blog.haskell.org/authors/mateusz-goslinowski/">Mateusz Goślinowski</a> <span class="rpad"></span> January 08, 2025 <span class="rpad"></span> [<a href="https://blog.haskell.org/categories/ghc/">GHC</a>] #<a href="https://blog.haskell.org/tags/javascript/">javascript</a>  #<a href="https://blog.haskell.org/tags/case-study/">case-study</a> </span>

    


<p>GHC since version 9.8 allows us to create callbacks from JS to Haskell code, which enables us to create full-fledged browser apps.
This article shows how to use the JS backend with foreign component libraries.</p>
<span id="continue-reading"></span>
<ul>
<li>repository: https://github.com/Swordlash/halogen-blog</li>
<li>ghc used: javascript-unknown-ghcjs-ghc-9.12.1 (ghcup)</li>
</ul>
<h2 id="preface">Preface</h2>
<p>Any useful browser single-page application needs to be able to react to user input to modify the webpage content on response.
Since GHC version 9.8 release, we can instantiate JavaScript-level functions with Haskell closures, allowing us to pass Haskell-level actions to DOM event listeners.</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell">foreign <span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> jav<span class="z-keyword z-other z-haskell">as</span>cript unsafe </span>
</span><span class="z-source z-haskell">  <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span><span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span> </span>
</span><span class="z-source z-haskell">  ((f) <span class="z-keyword z-operator z-haskell">=&gt;</span> { 
</span><span class="z-source z-haskell">    var node <span class="z-keyword z-operator z-haskell">=</span> document<span class="z-keyword z-operator z-haskell">.</span>createElement(<span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>button<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>); 
</span><span class="z-source z-haskell">    node<span class="z-keyword z-operator z-haskell">.</span>textContent <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Click me!<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>; 
</span><span class="z-source z-haskell">    node<span class="z-keyword z-operator z-haskell">.</span>onclick <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-language z-unit z-haskell">()</span> <span class="z-keyword z-operator z-haskell">=&gt;</span> { 
</span><span class="z-source z-haskell">      node<span class="z-keyword z-operator z-haskell">.</span>textContent <span class="z-keyword z-operator z-haskell">=</span> `<span class="z-constant z-other z-haskell">Clicked</span> <span class="z-keyword z-operator z-haskell">$</span>{f<span class="z-constant z-language z-unit z-haskell">()</span>} times`;
</span><span class="z-source z-haskell">    }; 
</span><span class="z-source z-haskell">    document<span class="z-keyword z-operator z-haskell">.</span>body<span class="z-keyword z-operator z-haskell">.</span>appendChild(node);
</span><span class="z-source z-haskell">  })
</span><span class="z-source z-haskell">  <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span><span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell">  <span class="z-entity z-name z-function z-haskell">install_handler</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Callback</span> (<span class="z-storage z-type z-haskell">IO</span> <span class="z-storage z-type z-haskell">JSVal</span>) <span class="z-keyword z-other z-arrow z-haskell">-&gt;</span> <span class="z-storage z-type z-haskell">IO</span> <span class="z-support z-constant z-unit z-haskell">()</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell">
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">main</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">IO</span> <span class="z-support z-constant z-unit z-haskell">()</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>main <span class="z-keyword z-operator z-haskell">=</span> <span class="z-keyword z-control z-haskell">do</span>
</span><span class="z-source z-haskell">  ref <span class="z-keyword z-operator z-haskell">&lt;-</span> newIORef <span class="z-constant z-numeric z-integer z-decimal z-haskell">0</span>
</span><span class="z-source z-haskell">  <span class="z-keyword z-other z-haskell">let</span> incRef <span class="z-keyword z-operator z-haskell">=</span> toJSInt <span class="z-keyword z-operator z-haskell">&lt;$&gt;</span> (modifyIORef&#39; ref (<span class="z-keyword z-operator z-haskell">+</span><span class="z-constant z-numeric z-integer z-decimal z-haskell">1</span>) *<span class="z-keyword z-operator z-haskell">&gt;</span> readIORef ref)
</span><span class="z-source z-haskell">  syncCallback&#39; incRef <span class="z-keyword z-operator z-haskell">&gt;&gt;=</span> install_handler
</span></code></pre>
<p>In the above snippet we're creating an <code>IORef</code> and pass a callback incrementing it to a foreign function that installs a button in body, counting a number of clicks
(note for brevity I used a multiline syntax that is not yet available for foreign calls). The callback closes over the <code>IORef</code> and correctly updates the number after each click.</p>
<center>
<video src="https://github.com/user-attachments/assets/ceb86903-d136-4821-8e2d-de2e433889a5" type="video/quicktime" controls></video>
</center>
<p>Callbacks fully enable probably the most fascinating purpose of JavaScript backend, which is web programming. GHCJS has been around for quite some time now,
however it is both outdated (being a GHC fork requiring separate maintenance; currently stuck on 8.10) and cumbersome to use (often necessitating a separate setup, typically through Nix). In one of my previous companies, while evaluating potential options for rewriting the frontend, I decided to use PureScript. It was close enough to Haskell and very easy to set up - it can be installed directly through <code>npm</code>, has its own <code>stack</code>-like package manager <code>spago</code> with a suite of existing bundler plugins, and a blazing fast language server.
During this journey I was using <a rel="noopener" target="_blank" href="https://github.com/purescript-halogen/purescript-halogen">purescript-halogen</a> library - a typesafe, declarative VDOM framework based on <a rel="noopener" target="_blank" href="https://guide.elm-lang.org/architecture/">The Elm Architecture</a>.</p>
<p>However, with all the joy that the Haskell-like web programming brought me, I couldn't shake the feeling that there is a room for improvement. From the small things that are
always annoying in polyglot stacks (like FE-BE JSON encoding discrepancies or lack of code sharing), to sometimes very illegible <code>purs</code> compiler error messages and of course lack of a lot of language features. This is not my intention to criticize - for a language this small I was amazed by the number and quality of existing tools and frameworks and plenty of documentation; the overall experience exceeded my expectations by far. I would still recommend PureScript to anyone that wants a lightweight, easy to setup web language with strong type system.</p>
<p>However the mentioned shortcomings were why I was closely following the development of the GHC JS backend, wishing to port the <code>purescript-halogen</code> library to GHC as soon as it's possible. A fruit of this labour was recently released as <a rel="noopener" target="_blank" href="https://github.com/Swordlash/haskell-halogen">haskell-halogen</a>.</p>
<h2 id="using-javascript-backend-with-existing-javascript-tools">Using JavaScript backend with existing JavaScript tools</h2>
<p>Yet, even the most complex and technically beautiful undertaking is worthless if its fruits are not usable.
One of the measures of such usability in this case is interoperability with the JavaScript ecosystem - existing libraries, bundlers, minifiers, as well of the performance (size and speed) of the generated code.</p>
<h3 id="optimizing-and-bundling">Optimizing and bundling</h3>
<p>Currently, <code>google-closure-compiler</code> is supported for minification of the bundle (see the blog post on <a rel="noopener" target="_blank" href="https://blog.haskell.org/report-of-js-code-minification/">JS code minification</a>). Let's try it.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./run_example 1</span>
</span><span class="z-source z-shell z-bash"><span class="z-punctuation z-definition z-compound z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span><span class="z-punctuation z-definition z-compound z-end z-shell">)</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">+</span></span><span class="z-meta z-function-call z-arguments z-shell"> npx google-closure-compiler<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>language_in</span> UNSTABLE<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>compilation_level</span> ADVANCED_OPTIMIZATIONS<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>warning_level</span> QUIET<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>isolation_mode</span> IIFE<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>assume_function_wrapper</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>emit_use_strict</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> /home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example1-0.1.0.0/x/example1/build/example1/example1.jsexe/all.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> /home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example1-0.1.0.0/x/example1/build/example1/example1.jsexe/all.externs.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js_output_file</span> ../dev/index.js</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Input</span></span><span class="z-meta z-function-call z-arguments z-shell"> size: 1.8M</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Output</span></span><span class="z-meta z-function-call z-arguments z-shell"> size: 396K</span>
</span></code></pre>
<p>Notice we have to call <code>google-closure-compiler</code> with two input files: first is the <code>all.js</code> package generated by the compiler after bundling our library with all dependencies,
GHC's RTS and emscripten RTS files; second, is the <code>all.externs.js</code> file that declares external variables for the minifier. Its purpose is twofold - It informs the compiler that those variables are declared elsewhere, as not to fail with an "undeclared variable" error, and it prevents the mangling of those identifiers during minification.
Note we had to add <code>--language_in UNSTABLE</code> when compiling for recent <code>emscripten</code> due to <a rel="noopener" target="_blank" href="https://github.com/emscripten-core/emscripten/issues/23179">this issue</a>.</p>
<p>Nice! We reduced size of the js file from 1.8M to merely 396K. This is even smaller after compression:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> brotli<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>Z</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>o</span> dev/index.js.br dev/index.js</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> du<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>h</span> dev/index.js.br</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">76K</span></span><span class="z-meta z-function-call z-arguments z-shell">     dev/index.js.br</span>
</span></code></pre>
<p>Now, in the real life we very rarely just serve one file; we usually pull some external dependencies, stylesheets, static files. Those then get processed
into a smaller number of optimized output files in a process called bundling. <code>parcel</code> is one of the simplest bundlers out there - it scans your html file
for dependencies, recursively checks for js files embedded there and their dependencies, and has sensible defaults for installing browser polyfills on
things that are <code>require</code>d in code. Let's check it out.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> npx parcel dev/index.html</span>
</span><span class="z-source z-shell z-bash"><span class="z-punctuation z-definition z-compound z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">this</span></span><span class="z-meta z-function-call z-arguments z-shell"> is going to install some polyfill libraries like os-browserify</span><span class="z-punctuation z-definition z-compound z-end z-shell">)</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Server</span></span><span class="z-meta z-function-call z-arguments z-shell"> running at http://localhost:1234</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">✨</span></span><span class="z-meta z-function-call z-arguments z-shell"> Built in 1.55s</span>
</span></code></pre>
<p>Great! Let's check out the page.</p>
<p>And behold!.. an empty page. What's happening? A quick look in dev console shows an issue:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Uncaught</span></span><span class="z-meta z-function-call z-arguments z-shell"> Error: process.binding is not supported</span>
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">at</span></span><span class="z-meta z-function-call z-arguments z-shell"> process.binding (browser.js:177:11</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">at</span></span><span class="z-meta z-function-call z-arguments z-shell"> Object.<span class="z-keyword z-operator z-assignment z-redirection z-shell">&lt;</span>anonymous<span class="z-keyword z-operator z-assignment z-redirection z-shell">&gt;</span> (index.js:144:368</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">at</span></span><span class="z-meta z-function-call z-arguments z-shell"> d9Zcj.6c0765b8bdc1a4da (index.js:898:391</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">at</span></span><span class="z-meta z-function-call z-arguments z-shell"> newRequire (index.f708bf3c.js:71:24</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">at</span></span><span class="z-meta z-function-call z-arguments z-shell"> index.f708bf3c.js:122:5</span>
</span><span class="z-source z-shell z-bash">    <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">at</span></span><span class="z-meta z-function-call z-arguments z-shell"> index.f708bf3c.js:145:3</span>
</span></code></pre>
<p>Looking at the error, this comes from a parcel polyfill library for <code>process</code>. Why is <code>process</code> ever used?
After some digging I found a related <a rel="noopener" target="_blank" href="https://github.com/parcel-bundler/parcel/issues/4468#issuecomment-613598904">issue comment</a> in <code>parcel</code> and
the affected <code>ghc-internal</code> <a rel="noopener" target="_blank" href="https://gitlab.haskell.org/ghc/ghc/-/blob/777f108f/libraries/ghc-internal/jsbits/platform.js#L49">line</a>.
So it seems <code>parcel</code> is wrapping the processed module in a "header" that provides <code>require</code>, which confuses the <code>ghc-internal</code> over which environment
it's running in - it thinks that since <code>require</code> is available it is running in <code>nodejs</code>, and calls the <code>process.binding</code> which is not polyfilled.</p>
<p>Yuck!</p>
<p>Now, there is an option to compile without this code entirely and omit the environment checking at all, if you configure your GHC in the following way:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-variable z-other z-readwrite z-assignment z-shell">CONF_CC_OPTS_STAGE2</span><span class="z-keyword z-operator z-assignment z-shell">=</span><span class="z-string z-unquoted z-shell"><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>-sENVIRONMENT=web<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">emconfigure</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./configure<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>target</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span>javascript-unknown-ghcjs<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>with-js-cpp-flags</span><span class="z-keyword z-operator z-assignment z-option z-shell">=</span><span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>-DGHCJS_BROWSER -E -CC -Wno-unicode -nostdinc<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span></code></pre>
<p>This way all environment checking code will be dropped, and <code>emcc</code> will compile-in only web-related part of its runtime.
However, it being ghc-compile-time option (not link time option unlike in GHCJS), it's cumbersome to use and maintain from GHC side (separate testing, CI etc.), and also half-baked and not supported in all boot libraries (see GHC <a rel="noopener" target="_blank" href="https://gitlab.haskell.org/ghc/ghc/-/merge_requests/13779">PR</a> with sub-PRs fixing it in <code>unix</code> and <code>process</code>).</p>
<p>Therefore, we need to abandon hopes about <code>parcel</code> for now. How about <code>webpack</code>?</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> cat config/webpack.config.js </span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">const</span></span><span class="z-meta z-function-call z-arguments z-shell"> path = require(<span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>path<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span></span><span class="z-meta z-function-call z-shell"></span>)<span class="z-keyword z-operator z-logical z-continue z-shell">;</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">const</span></span><span class="z-meta z-function-call z-arguments z-shell"> HtmlWebpackPlugin = require(<span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>html-webpack-plugin<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span></span><span class="z-meta z-function-call z-shell"></span>)<span class="z-keyword z-operator z-logical z-continue z-shell">;</span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">module.exports</span></span><span class="z-meta z-function-call z-arguments z-shell"> = <span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-begin z-shell">{</span>
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">  entry: <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>./dev/index.js<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span><span class="z-punctuation z-separator z-shell">,</span>
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">  output: <span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-begin z-shell">{</span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">    filename: <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>main.js<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span><span class="z-punctuation z-separator z-shell">,</span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">    path: path.resolve(__dirname<span class="z-punctuation z-separator z-shell">,</span> <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>../dist<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span>)<span class="z-punctuation z-separator z-shell">,</span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">  <span class="z-punctuation z-section z-expansion z-brace z-end z-shell">}</span></span><span class="z-punctuation z-separator z-shell">,</span>
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">  resolve: <span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-begin z-shell">{</span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">    fallback: <span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-begin z-shell">{</span>
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">      os: false<span class="z-punctuation z-separator z-shell">,</span>
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">      fs: false<span class="z-punctuation z-separator z-shell">,</span>
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">      child_process: false<span class="z-punctuation z-separator z-shell">,</span>
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">      path: false<span class="z-punctuation z-separator z-shell">,</span>
</span></span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">    <span class="z-punctuation z-section z-expansion z-brace z-end z-shell">}</span></span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">  <span class="z-punctuation z-section z-expansion z-brace z-end z-shell">}</span></span><span class="z-punctuation z-separator z-shell">,</span>
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">  plugins: 
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">    [ new HtmlWebpackPlugin(<span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-begin z-shell">{</span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">        title: <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>Blog<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span>
</span></span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-meta z-group z-expansion z-brace z-shell">    <span class="z-punctuation z-section z-expansion z-brace z-end z-shell">}</span></span>)]
</span></span></span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-arguments z-shell"><span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-end z-shell">}</span></span></span><span class="z-keyword z-operator z-logical z-continue z-shell">;</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> npx webpack build<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>config</span> config/webpack.config.js</span> <span class="z-keyword z-operator z-logical z-and z-shell">&amp;&amp;</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">npx</span></span><span class="z-meta z-function-call z-arguments z-shell"> http-server dist/</span>
</span><span class="z-source z-shell z-bash"><span class="z-punctuation z-definition z-compound z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span><span class="z-punctuation z-definition z-compound z-end z-shell">)</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Starting</span></span><span class="z-meta z-function-call z-arguments z-shell"> up http-server, serving dist/</span>
</span></code></pre>
<p>It works! The button appeared on screen and the console errors disappeared.</p>
<h3 id="bundling-with-external-deps">Bundling with external deps</h3>
<p>Now, the above was only child's play since we didn't have any actual external dependencies to bundle, only our code.
Let's create something more involved. Let's have our button be styled and managed by Google Material Components library.</p>
<p>Doing it is very simple, as decribed in the <a rel="noopener" target="_blank" href="https://m2.material.io/components/buttons/web#using-buttons">Material documentation</a>. We basically have to</p>
<ul>
<li>Create an HTML button component structure on page as described in docs:</li>
</ul>
<pre data-lang="html" class="language-html z-code"><code class="language-html" data-lang="html"><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;</span><span class="z-entity z-name z-tag z-block z-any z-html">div</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">mdc-touch-target-wrapper</span><span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span><span class="z-text z-html z-basic">  <span class="z-meta z-tag z-inline z-form z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;</span><span class="z-entity z-name z-tag z-inline z-form z-html">button</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">mdc-button</span> <span class="z-meta z-class-name z-html">mdc-button--outlined</span> <span class="z-meta z-class-name z-html">mdc-button--icon-leading</span><span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span> <span class="z-comment z-block z-html"><span class="z-punctuation z-definition z-comment z-begin z-html">&lt;!--</span> this is {element} in below code <span class="z-punctuation z-definition z-comment z-end z-html">--&gt;</span></span>
</span><span class="z-text z-html z-basic">    <span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;</span><span class="z-entity z-name z-tag z-inline z-any z-html">span</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">mdc-button__ripple</span><span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span><span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;/</span><span class="z-entity z-name z-tag z-inline z-any z-html">span</span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span><span class="z-text z-html z-basic">    <span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;</span><span class="z-entity z-name z-tag z-inline z-any z-html">span</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">mdc-button__touch</span><span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span><span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;/</span><span class="z-entity z-name z-tag z-inline z-any z-html">span</span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span><span class="z-text z-html z-basic">    <span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;</span><span class="z-entity z-name z-tag z-inline z-any z-html">i</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">material-icons</span> <span class="z-meta z-class-name z-html">mdc-button__icon</span><span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span> <span class="z-meta z-attribute-with-value z-html"><span class="z-entity z-other z-attribute-name z-html">aria-hidden</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span>true<span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>bookmark<span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;/</span><span class="z-entity z-name z-tag z-inline z-any z-html">i</span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span><span class="z-text z-html z-basic">    <span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;</span><span class="z-entity z-name z-tag z-inline z-any z-html">span</span> <span class="z-meta z-attribute-with-value z-class z-html"><span class="z-entity z-other z-attribute-name z-class z-html">class</span><span class="z-punctuation z-separator z-key-value z-html">=</span><span class="z-string z-quoted z-double z-html"><span class="z-punctuation z-definition z-string z-begin z-html">&quot;</span></span><span class="z-string z-quoted z-double z-html"><span class="z-meta z-class-name z-html">mdc-button__label</span><span class="z-punctuation z-definition z-string z-end z-html">&quot;</span></span></span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>My Accessible Button<span class="z-meta z-tag z-inline z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;/</span><span class="z-entity z-name z-tag z-inline z-any z-html">span</span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span><span class="z-text z-html z-basic">  <span class="z-meta z-tag z-inline z-form z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;/</span><span class="z-entity z-name z-tag z-inline z-form z-html">button</span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span><span class="z-text z-html z-basic"><span class="z-meta z-tag z-block z-any z-html"><span class="z-punctuation z-definition z-tag z-begin z-html">&lt;/</span><span class="z-entity z-name z-tag z-block z-any z-html">div</span><span class="z-punctuation z-definition z-tag z-end z-html">&gt;</span></span>
</span></code></pre>
<ul>
<li>"Activate" the material library on it:</li>
</ul>
<pre data-lang="javascript" class="language-javascript z-code"><code class="language-javascript" data-lang="javascript"><span class="z-source z-ts"><span class="z-meta z-import z-ts"><span class="z-keyword z-control z-import z-ts">import</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-variable z-other z-readwrite z-alias z-ts">MDCRipple</span><span class="z-punctuation z-definition z-block z-ts">}</span></span> <span class="z-keyword z-control z-from z-ts">from</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>@material/ripple<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">buttonRipple</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">MDCRipple</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">element</span><span class="z-meta z-brace z-round z-ts">)</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre>
<ul>
<li>Import material styles and icons into your <code>.scss</code> bundle</li>
<li>Destroy the element once it's removed from DOM: <code>buttonRipple.destroy()</code>.</li>
</ul>
<p>With this, we can start implementation!
file: <a rel="noopener" target="_blank" href="https://github.com/Swordlash/halogen-blog/blob/master/example2/src/Button.hs">example2/src/Button.hs</a></p>
<p>First, a few imports:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen</span> <span class="z-keyword z-other z-haskell">hiding</span> <span class="z-meta z-declaration z-exports z-haskell">(<span class="z-storage z-type z-haskell">Initialize</span><span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-storage z-type z-haskell">Finalize</span><span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-storage z-type z-haskell">State</span>)</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen.HTML</span> <span class="z-keyword z-other z-haskell">qualified</span> <span class="z-keyword z-other z-haskell">as</span> <span class="z-support z-other z-module z-haskell">HH</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen.HTML.Properties</span> <span class="z-keyword z-other z-haskell">qualified</span> <span class="z-keyword z-other z-haskell">as</span> <span class="z-support z-other z-module z-haskell">HP</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen.HTML.Properties.ARIA</span> <span class="z-keyword z-other z-haskell">qualified</span> <span class="z-keyword z-other z-haskell">as</span> <span class="z-support z-other z-module z-haskell">HPA</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen.HTML.Events</span> <span class="z-keyword z-other z-haskell">qualified</span> <span class="z-keyword z-other z-haskell">as</span> <span class="z-support z-other z-module z-haskell">HE</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Web.DOM.Internal.Types</span> <span class="z-meta z-declaration z-exports z-haskell">(<span class="z-storage z-type z-haskell">HTMLElement</span>)</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Control.Monad.State</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Data.Foreign</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Data.Foldable</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Data.Text</span> <span class="z-keyword z-other z-haskell">qualified</span> <span class="z-keyword z-other z-haskell">as</span> <span class="z-support z-other z-module z-haskell">T</span></span>
</span></code></pre>
<p>We are going to use foreign import for initializing and destroying a button ripple effect. We will include this code in <code>js-sources</code> field of the package's cabal file:</p>
<pre data-lang="cabal" class="language-cabal z-code"><code class="language-cabal" data-lang="cabal"><span class="z-text z-plain">library
</span><span class="z-text z-plain">  (..)
</span><span class="z-text z-plain">  js-sources: src/Button.js
</span></code></pre>
<p>The js file itself is quite simple and doesn't do much - we import the needed module and expose two mentioned functions.</p>
<pre data-lang="javascript" class="language-javascript z-code"><code class="language-javascript" data-lang="javascript"><span class="z-source z-ts"><span class="z-meta z-import z-ts"><span class="z-keyword z-control z-import z-ts">import</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-variable z-other z-readwrite z-alias z-ts">MDCRipple</span><span class="z-punctuation z-definition z-block z-ts">}</span></span> <span class="z-keyword z-control z-from z-ts">from</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>@material/ripple<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-definition z-function z-ts"><span class="z-entity z-name z-function z-ts">init_ripple</span></span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">element</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts">  <span class="z-keyword z-control z-flow z-ts">return</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">MDCRipple</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">element</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-definition z-function z-ts"><span class="z-entity z-name z-function z-ts">destroy_ripple</span></span><span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">ripple</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts">  <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">ripple</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">destroy</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-function z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span></span>
</span></code></pre>
<p>Now, in the haskell file, using <code>Data.Foreign</code> module of <code>haskell-halogen</code> (which is just a type-tagged newtype over <code>GHC.JS.Prim.JSVal</code>), we define our imports:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">newtype</span> <span class="z-constant z-other z-haskell">MDCRipple</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">MDCRipple</span> (<span class="z-constant z-other z-haskell">Foreign</span> <span class="z-constant z-other z-haskell">MDCRipple</span>)
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell">foreign <span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> jav<span class="z-keyword z-other z-haskell">as</span>cript unsafe &quot;init_ripple&quot; init<span class="z-support z-other z-module z-haskell">Ripple</span> :: <span class="z-support z-other z-module z-haskell">HTMLElement</span> -&gt; <span class="z-support z-other z-module z-haskell">IO</span> <span class="z-support z-other z-module z-haskell">MDCRipple</span></span>
</span><span class="z-source z-haskell">foreign <span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> jav<span class="z-keyword z-other z-haskell">as</span>cript unsafe &quot;destroy_ripple&quot; destroy<span class="z-support z-other z-module z-haskell">Ripple</span> :: <span class="z-support z-other z-module z-haskell">MDCRipple</span> -&gt; <span class="z-support z-other z-module z-haskell">IO</span> <span class="z-meta z-declaration z-exports z-haskell">()</span></span>
</span></code></pre>
<p>Note, because <code>HTMLElement</code> and <code>MDCRipple</code> runtime representation is that of a <code>JSVal</code>, we can specify them directly in signatures without the need of unwrapping arguments into <code>JSVals</code> and wrapping <code>JSVal</code> results back.</p>
<p>The Halogen library uses the Elm Architecture, so we need to specify the state of our button component and its actions. Our state will simply be a pair of <code>(foreign MDCRipple, click counter)</code>. The actions will be <code>Initialize</code> and <code>Finalize</code>, called when the element is added and removed from DOM, and <code>Click</code>:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">data</span> <span class="z-constant z-other z-haskell">Action</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Initialize</span> <span class="z-keyword z-operator z-haskell">|</span> <span class="z-constant z-other z-haskell">Finalize</span> <span class="z-keyword z-operator z-haskell">|</span> <span class="z-constant z-other z-haskell">Click</span>
</span><span class="z-source z-haskell"><span class="z-keyword z-other z-haskell">data</span> <span class="z-constant z-other z-haskell">State</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">State</span> { ripple <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">Maybe</span> <span class="z-constant z-other z-haskell">MDCRipple</span><span class="z-punctuation z-separator z-comma z-haskell">,</span> counter <span class="z-keyword z-operator z-haskell">::</span> <span class="z-constant z-other z-haskell">Int</span> }
</span></code></pre>
<p>Note <code>ripple</code> is <code>Nothing</code> at the beginning, when our button is in DOM but the <code>Initialize</code> hasn't been dispatched yet. Now it's time for the rest of the plumbing:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">button</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">Component</span> <span class="z-variable z-other z-generic-type z-haskell">q</span> <span class="z-variable z-other z-generic-type z-haskell">i</span> <span class="z-variable z-other z-generic-type z-haskell">o</span> <span class="z-storage z-type z-haskell">IO</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>button <span class="z-keyword z-operator z-haskell">=</span> mkComponent <span class="z-keyword z-operator z-haskell">$</span> <span class="z-constant z-other z-haskell">ComponentSpec</span>
</span><span class="z-source z-haskell">  { initialState <span class="z-keyword z-operator z-haskell">=</span> const <span class="z-keyword z-operator z-haskell">$</span> <span class="z-constant z-other z-haskell">State</span> <span class="z-constant z-other z-haskell">Nothing</span> <span class="z-constant z-numeric z-integer z-decimal z-haskell">0</span>
</span><span class="z-source z-haskell">  <span class="z-punctuation z-separator z-comma z-haskell">,</span> render
</span><span class="z-source z-haskell">  <span class="z-punctuation z-separator z-comma z-haskell">,</span> eval <span class="z-keyword z-operator z-haskell">=</span> mkEval <span class="z-keyword z-operator z-haskell">$</span> defaultEval { handleAction<span class="z-punctuation z-separator z-comma z-haskell">,</span> initialize <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Just</span> <span class="z-constant z-other z-haskell">Initialize</span><span class="z-punctuation z-separator z-comma z-haskell">,</span> finalize <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Just</span> <span class="z-constant z-other z-haskell">Finalize</span> }
</span><span class="z-source z-haskell">  }
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell">  <span class="z-keyword z-other z-haskell">where</span>
</span><span class="z-source z-haskell">    ref <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">RefLabel</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span> <span class="z-comment z-line z-double-dash z-haskell"><span class="z-punctuation z-definition z-comment z-haskell">--</span> reference that is added to .mdc-button element, to look it up in DOM and initialize with foreign code
</span></span><span class="z-source z-haskell">
</span><span class="z-source z-haskell">    text <span class="z-constant z-numeric z-integer z-decimal z-haskell">0</span> <span class="z-keyword z-operator z-haskell">=</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Click me!<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>
</span><span class="z-source z-haskell">    text n <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">T</span><span class="z-keyword z-operator z-haskell">.</span>pack <span class="z-keyword z-operator z-haskell">$</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Clicked <span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span> <span class="z-keyword z-operator z-haskell">&lt;&gt;</span> show n <span class="z-keyword z-operator z-haskell">&lt;&gt;</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span> times<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell">    render <span class="z-constant z-other z-haskell">State</span>{counter} <span class="z-keyword z-operator z-haskell">=</span> 
</span><span class="z-source z-haskell">      <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>div [<span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>class_ (<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-touch-target-wrapper<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>)]
</span><span class="z-source z-haskell">        <span class="z-keyword z-operator z-haskell">$</span> pure
</span><span class="z-source z-haskell">        <span class="z-keyword z-operator z-haskell">$</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>button
</span><span class="z-source z-haskell">          [ <span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>classes 
</span><span class="z-source z-haskell">            [ <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button--outlined<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button--icon-leading<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span> ] <span class="z-comment z-line z-double-dash z-haskell"><span class="z-punctuation z-definition z-comment z-haskell">--</span> the element in question
</span></span><span class="z-source z-haskell">            <span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HE</span><span class="z-keyword z-operator z-haskell">.</span>onClick (const <span class="z-constant z-other z-haskell">Click</span>) <span class="z-comment z-line z-double-dash z-haskell"><span class="z-punctuation z-definition z-comment z-haskell">--</span> this action is returned when button is clicked
</span></span><span class="z-source z-haskell">            <span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>ref ref <span class="z-comment z-line z-double-dash z-haskell"><span class="z-punctuation z-definition z-comment z-haskell">--</span> we add reference here
</span></span><span class="z-source z-haskell">          ]
</span><span class="z-source z-haskell">          <span class="z-comment z-line z-double-dash z-haskell"><span class="z-punctuation z-definition z-comment z-haskell">--</span> rest of the HTML as the documentation specifies
</span></span><span class="z-source z-haskell">          [ <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>span [<span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>class_ (<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button__ripple<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>)] <span class="z-constant z-language z-empty-list z-haskell">[]</span>
</span><span class="z-source z-haskell">          <span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>span [<span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>class_ (<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button__touch<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>)] <span class="z-constant z-language z-empty-list z-haskell">[]</span>
</span><span class="z-source z-haskell">          <span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>i [<span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>classes [<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>material-icons<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span><span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button__icon<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>]<span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HPA</span><span class="z-keyword z-operator z-haskell">.</span>hidden <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>true<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>] [<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>text <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>add<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>]
</span><span class="z-source z-haskell">          <span class="z-punctuation z-separator z-comma z-haskell">,</span> <span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>span [<span class="z-constant z-other z-haskell">HP</span><span class="z-keyword z-operator z-haskell">.</span>class_ (<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span><span class="z-constant z-other z-haskell">ClassName</span> <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>mdc-button__label<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>)] [<span class="z-constant z-other z-haskell">HH</span><span class="z-keyword z-operator z-haskell">.</span>text <span class="z-keyword z-operator z-haskell">$</span> text counter]
</span><span class="z-source z-haskell">          ]
</span></code></pre>
<p>Pretty straightforward, now the action handling:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell">    handleAction <span class="z-constant z-other z-haskell">Click</span> <span class="z-keyword z-operator z-haskell">=</span> modify&#39; <span class="z-keyword z-operator z-haskell">$</span> <span class="z-keyword z-operator z-haskell">\</span>s <span class="z-keyword z-operator z-haskell">-&gt;</span> s { counter <span class="z-keyword z-operator z-haskell">=</span> counter s <span class="z-keyword z-operator z-haskell">+</span> <span class="z-constant z-numeric z-integer z-decimal z-haskell">1</span> }
</span><span class="z-source z-haskell">    handleAction <span class="z-constant z-other z-haskell">Finalize</span> <span class="z-keyword z-operator z-haskell">=</span> gets ripple <span class="z-keyword z-operator z-haskell">&gt;&gt;=</span> traverse_ (liftIO <span class="z-keyword z-operator z-haskell">.</span> destroyRipple)
</span><span class="z-source z-haskell">    handleAction <span class="z-constant z-other z-haskell">Initialize</span> <span class="z-keyword z-operator z-haskell">=</span>
</span><span class="z-source z-haskell">      getHTMLElementRef ref <span class="z-keyword z-operator z-haskell">&gt;&gt;=</span> <span class="z-keyword z-operator z-haskell">\</span><span class="z-keyword z-other z-haskell">case</span>
</span><span class="z-source z-haskell">        <span class="z-constant z-other z-haskell">Just</span> el <span class="z-keyword z-operator z-haskell">-&gt;</span> <span class="z-keyword z-control z-haskell">do</span>
</span><span class="z-source z-haskell">          r <span class="z-keyword z-operator z-haskell">&lt;-</span> liftIO <span class="z-keyword z-operator z-haskell">$</span> initRipple el 
</span><span class="z-source z-haskell">          modify&#39; (<span class="z-keyword z-operator z-haskell">\</span>s <span class="z-keyword z-operator z-haskell">-&gt;</span> s { ripple <span class="z-keyword z-operator z-haskell">=</span> <span class="z-constant z-other z-haskell">Just</span> r })
</span><span class="z-source z-haskell">        <span class="z-constant z-other z-haskell">Nothing</span> <span class="z-keyword z-operator z-haskell">-&gt;</span> error <span class="z-string z-quoted z-double z-haskell"><span class="z-punctuation z-definition z-string z-begin z-haskell">&quot;</span>Could not find button element<span class="z-punctuation z-definition z-string z-end z-haskell">&quot;</span></span>
</span></code></pre>
<p>And that's it. What's left is attaching this component to the <code>&lt;body&gt;</code> element in <code>Main.hs</code>:</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Button</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen.VDom.Driver</span> <span class="z-meta z-declaration z-exports z-haskell">(<span class="z-entity z-name z-function z-haskell">runUI</span>)</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Halogen.IO.Util</span></span>
</span><span class="z-source z-haskell"><span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> <span class="z-support z-other z-module z-haskell">Control.Monad</span> <span class="z-meta z-declaration z-exports z-haskell">(<span class="z-entity z-name z-function z-haskell">void</span>)</span></span>
</span><span class="z-source z-haskell">
</span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"><span class="z-entity z-name z-function z-haskell">main</span> <span class="z-keyword z-other z-double-colon z-haskell">::</span> <span class="z-storage z-type z-haskell">IO</span> <span class="z-support z-constant z-unit z-haskell">()</span>
</span></span><span class="z-source z-haskell"><span class="z-meta z-function z-type-declaration z-haskell"></span>main <span class="z-keyword z-operator z-haskell">=</span> awaitBody <span class="z-keyword z-operator z-haskell">&gt;&gt;=</span> void <span class="z-keyword z-operator z-haskell">.</span> runUI button <span class="z-constant z-language z-unit z-haskell">()</span>
</span></code></pre>
<p>Let's run the example.</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./run_example 2</span>
</span><span class="z-source z-shell z-bash"><span class="z-punctuation z-definition z-compound z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span><span class="z-punctuation z-definition z-compound z-end z-shell">)</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">+</span></span><span class="z-meta z-function-call z-arguments z-shell"> npx google-closure-compiler<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>language_in</span> UNSTABLE<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>compilation_level</span> ADVANCED_OPTIMIZATIONS<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>warning_level</span> QUIET<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>isolation_mode</span> IIFE<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>assume_function_wrapper</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>emit_use_strict</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> /home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example2-0.1.0.0/x/example2/build/example2/example2.jsexe/all.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> /home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example2-0.1.0.0/x/example2/build/example2/example2.jsexe/all.externs.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js_output_file</span> ./example2/assets/index.js</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">/home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example2-0.1.0.0/x/example2/build/example2/example2.jsexe/all.js:17760:0:</span></span><span class="z-meta z-function-call z-arguments z-shell"> ERROR - <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>JSC_INVALID_MODULE_PATH<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span> Invalid module path <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>@material/ripple<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span> for resolution mode <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&quot;</span>BROWSER<span class="z-punctuation z-definition z-string z-end z-shell">&quot;</span></span></span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">17760</span></span><span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">import</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-meta z-group z-expansion z-brace z-shell"><span class="z-punctuation z-section z-expansion z-brace z-begin z-shell">{</span>MDCRipple<span class="z-punctuation z-section z-expansion z-brace z-end z-shell">}</span></span> from <span class="z-string z-quoted z-single z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">&#39;</span>@material/ripple<span class="z-punctuation z-definition z-string z-end z-shell">&#39;</span></span></span><span class="z-keyword z-operator z-logical z-continue z-shell">;</span>
</span></code></pre>
<p>Oof. <code>google-closure-compiler</code> doesn't like our <code>import</code>. And it makes total sense, since it checks for undefined variables, so it doesn't know what are we importing.
Now, there isn't an easy way to fix this. We would essentially have to pass it all <code>node_modules</code> in question - unfortunately the webpack plugin is outdated; stuck at version Webpack 4.</p>
<p>However, there is a workaround if you really like <code>google-closure-compiler</code>, and want to use it. What we can do is not bundle the <code>js-sources</code>, but instead create externs
file for the closure compiler, and bundle the actual implementation later with webpack. To prevent name mangling just in case we hook our functions into <code>window</code> variable, like
some of the ponyfills do.</p>
<p>src/Button.externs.js</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-comment z-block z-documentation z-ts"><span class="z-punctuation z-definition z-comment z-ts">/**</span> <span class="z-storage z-type z-class z-jsdoc"><span class="z-punctuation z-definition z-block z-tag z-jsdoc">@</span>externs</span> <span class="z-punctuation z-definition z-comment z-ts">*/</span></span>
</span><span class="z-source z-ts"><span class="z-comment z-block z-documentation z-ts"><span class="z-punctuation z-definition z-comment z-ts">/**</span> <span class="z-storage z-type z-class z-jsdoc"><span class="z-punctuation z-definition z-block z-tag z-jsdoc">@</span>type</span> <span class="z-entity z-name z-type z-instance z-jsdoc"><span class="z-punctuation z-definition z-bracket z-curly z-begin z-jsdoc">{</span></span><span class="z-entity z-name z-type z-instance z-jsdoc">*</span><span class="z-entity z-name z-type z-instance z-jsdoc"><span class="z-punctuation z-definition z-bracket z-curly z-end z-jsdoc">}</span></span> <span class="z-punctuation z-definition z-comment z-ts">*/</span></span> <span class="z-support z-variable z-dom z-ts">window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">Halogen</span> <span class="z-keyword z-operator z-assignment z-ts">=</span><span class="z-meta z-objectliteral z-ts"> <span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-comment z-block z-documentation z-ts"><span class="z-punctuation z-definition z-comment z-ts">/**</span> <span class="z-storage z-type z-class z-jsdoc"><span class="z-punctuation z-definition z-block z-tag z-jsdoc">@</span>return</span> <span class="z-entity z-name z-type z-instance z-jsdoc"><span class="z-punctuation z-definition z-bracket z-curly z-begin z-jsdoc">{</span></span><span class="z-entity z-name z-type z-instance z-jsdoc">*</span><span class="z-entity z-name z-type z-instance z-jsdoc"><span class="z-punctuation z-definition z-bracket z-curly z-end z-jsdoc">}</span></span> <span class="z-punctuation z-definition z-comment z-ts">*/</span></span> <span class="z-support z-variable z-dom z-ts">window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-object z-property z-ts">Halogen</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">init_ripple</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">_el</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-comment z-block z-documentation z-ts"><span class="z-punctuation z-definition z-comment z-ts">/**</span> <span class="z-storage z-type z-class z-jsdoc"><span class="z-punctuation z-definition z-block z-tag z-jsdoc">@</span>return</span> <span class="z-entity z-name z-type z-instance z-jsdoc"><span class="z-punctuation z-definition z-bracket z-curly z-begin z-jsdoc">{</span></span><span class="z-entity z-name z-type z-instance z-jsdoc">*</span><span class="z-entity z-name z-type z-instance z-jsdoc"><span class="z-punctuation z-definition z-bracket z-curly z-end z-jsdoc">}</span></span> <span class="z-punctuation z-definition z-comment z-ts">*/</span></span> <span class="z-support z-variable z-dom z-ts">window</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-object z-property z-ts">Halogen</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">destroy_ripple</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function z-ts"><span class="z-storage z-type z-function z-ts">function</span> <span class="z-meta z-parameters z-ts"><span class="z-punctuation z-definition z-parameters z-begin z-ts">(</span><span class="z-variable z-parameter z-ts">_ripple</span><span class="z-punctuation z-definition z-parameters z-end z-ts">)</span></span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span><span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre>
<p>src/Button.hs</p>
<pre data-lang="haskell" class="language-haskell z-code"><code class="language-haskell" data-lang="haskell"><span class="z-source z-haskell">foreign <span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> jav<span class="z-keyword z-other z-haskell">as</span>cript unsafe &quot;window.<span class="z-support z-other z-module z-haskell">Halogen.init_ripple</span>&quot; init<span class="z-support z-other z-module z-haskell">Ripple</span> :: <span class="z-support z-other z-module z-haskell">HTMLElement</span> -&gt; <span class="z-support z-other z-module z-haskell">IO</span> <span class="z-support z-other z-module z-haskell">MDCRipple</span></span>
</span><span class="z-source z-haskell">foreign <span class="z-meta z-import z-haskell"><span class="z-keyword z-other z-haskell">import</span> jav<span class="z-keyword z-other z-haskell">as</span>cript unsafe &quot;window.<span class="z-support z-other z-module z-haskell">Halogen.destroy_ripple</span>&quot; destroy<span class="z-support z-other z-module z-haskell">Ripple</span> :: <span class="z-support z-other z-module z-haskell">MDCRipple</span> -&gt; <span class="z-support z-other z-module z-haskell">IO</span> <span class="z-meta z-declaration z-exports z-haskell">()</span></span>
</span></code></pre>
<p>Now we add it to our <code>google-closure-compiler</code> invocation:</p>
<pre data-lang="sh" class="language-sh z-code"><code class="language-sh" data-lang="sh"><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mateusz@m12844:<span class="z-meta z-group z-expansion z-tilde"><span class="z-variable z-language z-tilde z-shell">~</span></span>/personal/halogen-blog$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./run_example 2-workaround</span>
</span><span class="z-source z-shell z-bash"><span class="z-punctuation z-definition z-compound z-begin z-shell">(</span><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span><span class="z-punctuation z-definition z-compound z-end z-shell">)</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">+</span></span><span class="z-meta z-function-call z-arguments z-shell"> npx google-closure-compiler<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>language_in</span> UNSTABLE<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>compilation_level</span> ADVANCED_OPTIMIZATIONS<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>warning_level</span> QUIET<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>isolation_mode</span> IIFE<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>assume_function_wrapper</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>emit_use_strict</span><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> /home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example2-workaround-0.1.0.0/x/example2-workaround/build/example2-workaround/example2-workaround.jsexe/all.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> /home/mateusz/personal/halogen-blog/dist-newstyle/build/javascript-ghcjs/ghc-9.12.1/example2-workaround-0.1.0.0/x/example2-workaround/build/example2-workaround/example2-workaround.jsexe/all.externs.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js</span> ./example2-workaround/src/Button.externs.js<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> --</span>js_output_file</span> ./example2-workaround/assets/index.js</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Input</span></span><span class="z-meta z-function-call z-arguments z-shell"> size: 3.4M</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Output</span></span><span class="z-meta z-function-call z-arguments z-shell"> size: 756K</span>
</span></code></pre>
<p>Great! It passed! Now we add the real <code>Button.js</code> to entry files in webpack:</p>
<pre data-lang="javascript" class="language-javascript z-code"><code class="language-javascript" data-lang="javascript"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">mateusz</span>@<span class="z-entity z-name z-label z-ts">m12844</span><span class="z-punctuation z-separator z-label z-ts">:</span><span class="z-keyword z-operator z-bitwise z-ts">~</span><span class="z-keyword z-operator z-arithmetic z-ts">/</span><span class="z-variable z-other z-readwrite z-ts">personal</span><span class="z-keyword z-operator z-arithmetic z-ts">/</span><span class="z-variable z-other z-readwrite z-ts">halogen</span><span class="z-keyword z-operator z-arithmetic z-ts">-</span><span class="z-variable z-other z-readwrite z-ts">blog$</span> <span class="z-variable z-other z-readwrite z-ts">cat</span> <span class="z-variable z-other z-readwrite z-ts">example2</span><span class="z-keyword z-operator z-arithmetic z-ts">-</span><span class="z-variable z-other z-readwrite z-ts">workaround</span><span class="z-keyword z-operator z-arithmetic z-ts">/</span><span class="z-variable z-other z-readwrite z-ts">assets</span><span class="z-keyword z-operator z-arithmetic z-ts">/</span><span class="z-variable z-other z-object z-ts">webpack</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-object z-property z-ts">config</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-variable z-other z-property z-ts">js</span> 
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">path</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>path<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">HtmlWebpackPlugin</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>html-webpack-plugin<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-support z-type z-object z-module z-ts">module</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-type z-object z-module z-ts">exports</span> <span class="z-keyword z-operator z-assignment z-ts">=</span><span class="z-meta z-objectliteral z-ts"> <span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">entry</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>./example2-workaround/assets/index.js<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>./example2-workaround/assets/style.scss<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>./example2-workaround/src/Button.js<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">output</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">filename</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>main.js<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">path</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">path</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-promise z-ts">resolve</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-support z-variable z-object z-node z-ts">__dirname</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>../../dist<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">resolve</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">fallback</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">os</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-false z-ts">false</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">fs</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-false z-ts">false</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">child_process</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-false z-ts">false</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">path</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-false z-ts">false</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">  </span><span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">module</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">rules</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts">      <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">test</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-string z-regexp z-ts"> <span class="z-punctuation z-definition z-string z-begin z-ts">/</span><span class="z-constant z-character z-escape z-backslash z-regexp">\.</span>s<span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span>ac<span class="z-punctuation z-definition z-character-class z-regexp">]</span></span>ss<span class="z-keyword z-control z-anchor z-regexp">$</span><span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">i</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">use</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>style-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>css-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>sass-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts">    <span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">plugins</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> 
</span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts">    <span class="z-meta z-brace z-square z-ts">[</span> <span class="z-new z-expr z-ts"><span class="z-keyword z-operator z-new z-ts">new</span> <span class="z-entity z-name z-type z-ts">HtmlWebpackPlugin</span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-new z-expr z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">title</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>Blog<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-new z-expr z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">    </span><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-meta z-brace z-square z-ts">]</span></span>
</span></span></span></code></pre>
<p>We also use scss to add styles and font needed:</p>
<pre data-lang="scss" class="language-scss z-code"><code class="language-scss" data-lang="scss"><span class="z-source z-scss">mateusz@m<span class="z-constant z-numeric z-css">12844</span>:~/personal/<span class="z-meta z-selector z-css"><span class="z-entity z-name z-tag z-custom z-css">halogen-blog</span></span>$ cat<span class="z-meta z-selector z-css"> <span class="z-entity z-name z-tag z-custom z-css">example2-workaround</span></span>/assets/<span class="z-meta z-selector z-css"><span class="z-entity z-name z-tag z-css">style</span></span><span class="z-meta z-selector z-css"><span class="z-entity z-other z-attribute-name z-class z-css"><span class="z-punctuation z-definition z-entity z-css">.</span></span><span class="z-entity z-other z-attribute-name z-class z-css">scss</span> 
</span></span><span class="z-source z-scss"><span class="z-meta z-at-rule z-module z-sass"><span class="z-keyword z-control z-at-rule z-module z-sass"><span class="z-punctuation z-definition z-keyword z-sass">@</span>use</span> <span class="z-string z-quoted z-double z-css"><span class="z-punctuation z-definition z-string z-begin z-css">&quot;</span>@material/button/styles<span class="z-punctuation z-definition z-string z-end z-css">&quot;</span></span><span class="z-punctuation z-terminator z-rule z-sass">;</span></span>
</span><span class="z-source z-scss">
</span><span class="z-source z-scss"><span class="z-meta z-at-rule z-css"><span class="z-keyword z-control z-at-rule z-css"><span class="z-punctuation z-definition z-keyword z-css">@</span>font-face</span> </span><span class="z-punctuation z-section z-property-list z-begin z-css">{</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-family</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-string z-quoted z-single z-css"><span class="z-punctuation z-definition z-string z-begin z-css">&#39;</span>Material Icons<span class="z-punctuation z-definition z-string z-end z-css">&#39;</span></span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-style</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">normal</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-weight</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-constant z-numeric z-css">400</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">src</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-meta z-function-call z-css"><span class="z-support z-function z-url z-css">url</span><span class="z-meta z-group z-css"><span class="z-punctuation z-definition z-group z-begin z-css">(</span><span class="z-string z-unquoted z-css">https://</span><span class="z-string z-unquoted z-css">fonts.gstatic.com/s/materialicons/v142/flUhRq6tzZclQEJ-Vdg-IuiaDsNcIhQ8tQ.woff2</span></span><span class="z-meta z-group z-css"><span class="z-punctuation z-definition z-group z-end z-css">)</span></span></span> <span class="z-meta z-function-call z-css"><span class="z-support z-function z-font-face z-css">format</span><span class="z-meta z-group z-css"><span class="z-punctuation z-definition z-group z-begin z-css">(</span><span class="z-string z-quoted z-single z-css"><span class="z-punctuation z-definition z-string z-begin z-css">&#39;</span>woff2<span class="z-punctuation z-definition z-string z-end z-css">&#39;</span></span></span><span class="z-meta z-group z-css"><span class="z-punctuation z-definition z-group z-end z-css">)</span></span></span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss"><span class="z-punctuation z-section z-property-list z-end z-css">}</span>
</span><span class="z-source z-scss">
</span><span class="z-source z-scss"><span class="z-meta z-selector z-css"><span class="z-entity z-other z-attribute-name z-class z-css"><span class="z-punctuation z-definition z-entity z-css">.</span></span><span class="z-entity z-other z-attribute-name z-class z-css">material-icons</span> </span><span class="z-punctuation z-section z-property-list z-begin z-css">{</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-family</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-string z-quoted z-single z-css"><span class="z-punctuation z-definition z-string z-begin z-css">&#39;</span>Material Icons<span class="z-punctuation z-definition z-string z-end z-css">&#39;</span></span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-weight</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">normal</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-style</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">normal</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-size</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-constant z-numeric z-integer z-decimal z-css">24<span class="z-keyword z-other z-unit z-css">px</span></span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">line-height</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-constant z-numeric z-css">1</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">letter-spacing</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">normal</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">text-transform</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">none</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">display</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">inline-block</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">white-space</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">nowrap</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">word-wrap</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">normal</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">direction</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">ltr</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-vendor-prefix z-css">-webkit-</span><span class="z-support z-type z-property-name z-css">font-feature-settings</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-string z-quoted z-single z-css"><span class="z-punctuation z-definition z-string z-begin z-css">&#39;</span>liga<span class="z-punctuation z-definition z-string z-end z-css">&#39;</span></span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-property-name z-css">font-feature-settings</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-string z-quoted z-single z-css"><span class="z-punctuation z-definition z-string z-begin z-css">&#39;</span>liga<span class="z-punctuation z-definition z-string z-end z-css">&#39;</span></span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss">  <span class="z-meta z-property-name z-css"><span class="z-support z-type z-vendor-prefix z-css">-webkit-</span><span class="z-support z-type z-property-name z-css">font-smoothing</span></span><span class="z-punctuation z-separator z-key-value z-css">:</span><span class="z-meta z-property-value z-css"> <span class="z-support z-constant z-property-value z-css">antialiased</span></span><span class="z-punctuation z-terminator z-rule z-css">;</span>
</span><span class="z-source z-scss"><span class="z-punctuation z-section z-property-list z-end z-css">}</span>
</span></code></pre>
<p>And we're ready:</p>
<pre class="z-code"><code><span class="z-text z-plain">mateusz@m12844:~/personal/halogen-blog$webpack build --config example2-workaround/assets/webpack.config.js &amp;&amp; http-server dist/
</span><span class="z-text z-plain">(...)
</span><span class="z-text z-plain">Starting up http-server, serving dist/
</span></code></pre>
<p>Behold, a material button!</p>
<center>
<video src="https://github.com/user-attachments/assets/4abe2e52-0bd2-4cb7-99c0-c0b0a1796528" type="video/quicktime" controls></video>
</center>
<h3 id="bundling-with-webpack-and-swc-loader">Bundling with <code>webpack</code> and <code>swc-loader</code></h3>
<p>However, while the above trick works for standalone executables, it isn't really useful for libraries that have to ship with full code - haskell and javascript.
Requiring downstream users to add separately-shipped externs and js files to their pipeline sounds like an unpleasant thing to do, and exposes
them to too much implementation detail. Can we do better?</p>
<p>The answer is - yes, if we ditch the closure compiler but use <code>swc</code> instead. <a rel="noopener" target="_blank" href="https://swc.rs/">swc</a> is a Rust-based platform used by a lot of tools like <code>Parser</code>, <code>Next.js</code>
or <code>Vercel</code>, and provides its own minifier pipeline with webpack plugin.</p>
<p>What we have to do is, instead of installing our workaround and calling <code>google-closure-compiler</code>, add the following loader to our webpack file:</p>
<pre data-lang="javascript" class="language-javascript z-code"><code class="language-javascript" data-lang="javascript"><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> mateusz@m12844:~/personal/halogen-blog$ cat example2/assets/webpack.config.js</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-support z-type z-object z-module z-ts">module</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-type z-object z-module z-ts">exports</span> <span class="z-keyword z-operator z-assignment z-ts">=</span><span class="z-meta z-objectliteral z-ts"> <span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-whitespace z-comment z-leading z-ts">  </span><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> no more Button here, `index.js` is just a copy of `all.js`</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">entry</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span><span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>./example2/assets/index.js<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-single z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&#39;</span>./example2/assets/style.scss<span class="z-punctuation z-definition z-string z-end z-ts">&#39;</span></span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-whitespace z-comment z-leading z-ts">  </span><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> (...)</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">module</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">rules</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts">      <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">test</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-string z-regexp z-ts"> <span class="z-punctuation z-definition z-string z-begin z-ts">/</span><span class="z-constant z-character z-escape z-backslash z-regexp">\.</span>s<span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span>ac<span class="z-punctuation z-definition z-character-class z-regexp">]</span></span>ss<span class="z-keyword z-control z-anchor z-regexp">$</span><span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">i</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">use</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-meta z-array z-literal z-ts"> <span class="z-meta z-brace z-square z-ts">[</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>style-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>css-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>sass-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts">      <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">test</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-string z-regexp z-ts"> <span class="z-punctuation z-definition z-string z-begin z-ts">/</span><span class="z-constant z-character z-escape z-backslash z-regexp">\.</span>m<span class="z-keyword z-operator z-quantifier z-regexp">?</span>js<span class="z-keyword z-control z-anchor z-regexp">$</span><span class="z-punctuation z-definition z-string z-end z-ts">/</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">exclude</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span><span class="z-string z-regexp z-ts"> <span class="z-punctuation z-definition z-string z-begin z-ts">/</span><span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span>node_modules<span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-punctuation z-definition z-string z-end z-ts">/</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts">        <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">use</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">          <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">loader</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>swc-loader<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span>
</span></span></span></span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">        </span><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">      </span><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-array z-literal z-ts">    <span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">  <span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-whitespace z-comment z-leading z-ts">  </span><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> (...)</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> mateusz@m12844:~/personal/halogen-blog$ cat .swcrc</span>
</span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">  <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>minify<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span>: <span class="z-constant z-language z-boolean z-true z-ts">true</span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">  <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>jsc<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span>:<span class="z-meta z-objectliteral z-ts"> <span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts">    <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>minify<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>compress<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-true z-ts">true</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>mangle<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-true z-ts">true</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts">      <span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">&quot;</span>sourceMap<span class="z-punctuation z-definition z-string z-end z-ts">&quot;</span></span></span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-constant z-language z-boolean z-false z-ts">false</span>
</span></span></span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">    </span><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-meta z-object z-member z-ts">  </span><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></code></pre>
<p>And voilà! It all works as before. The uncompressed bundle size is slightly bigger (844 KiB vs 803 KiB with <code>google-closure-compiler</code>) however we don't need any more workarounds,
and we can safely ship our foreign code with imports to our users (provided they do install our <code>npm</code> dependencies).</p>
<p>A library with richer functionality is available <a rel="noopener" target="_blank" href="https://github.com/Swordlash/haskell-halogen-material">here</a>.
At the moment of writing, it contains Halogen components for customizable buttons, lists and tabbed panes.</p>
<h2 id="conclusion">Conclusion</h2>
<p>The above article shows how to use the JavaScript backend effectively and integrate it with foreign libraries, using <code>webpack</code> for bundling and <code>swc-loader</code> for minification/mangling.</p>
<p>What's next? There is still a lot to do in terms of code size &amp; performance, as well as integration with other tools:</p>
<ul>
<li>This cabal <a rel="noopener" target="_blank" href="https://github.com/haskell/cabal/pull/10722">PR</a> adds a new field, <code>js-options</code>, that allows passing custom flags to <code>js-sources</code> preprocessor.
Notably that would enable i.e. conditional compilation of traces along the lines of <code>#ifdef XXX &lt;put-trace&gt;</code> in foreign library code and <code>if flag(trace-flag) js-options: -optJSP-DXXX</code> in cabal file.</li>
<li>Low-hanging fruits like <a rel="noopener" target="_blank" href="https://gitlab.haskell.org/ghc/ghc/-/issues/25633">adding multiline strings support to inline foreign imports</a>.</li>
<li><a rel="noopener" target="_blank" href="https://gitlab.haskell.org/ghc/ghc/-/issues/25469">Integration efforts</a> with npm.</li>
</ul>
<p>What is still a minor unknown is deeper integration of the GHC build pipeline with <code>webpack</code> build pipeline, in the spirit of gathering <code>npm</code> libraries that need to be installed for each Haskell dependency, like <code>@material/button</code> in the above example.
I believe there will have to be a way of declaring inside the cabal package an <code>npm</code> dependency (something like the existing <code>pkgconfig-depends</code>) and
a webpack plugin will be created for loading haskell package for bundling.</p>
<p>Personally, I'm going to continue maintaining and developing the <code>haskell-halogen</code> and <code>haskell-halogen-material</code> libraries, adding more component classes to the latter.</p>
<h2 id="thanks">Thanks!</h2>
<p>Many thanks to <a rel="noopener" target="_blank" href="https://github.com/GulinSS">Serge S. Gulin</a> for his help and discussions on Matrix channel, and to <a rel="noopener" target="_blank" href="https://gitlab.haskell.org/Kleidukos">Hécate Kleidukos</a> for inviting me to write this blog post. I want also to thank <a rel="noopener" target="_blank" href="https://gitlab.haskell.org/hsyl20">Sylvain Henry</a> and <a rel="noopener" target="_blank" href="https://gitlab.haskell.org/luite">Luite Stegeman</a> for our mail and PR discussions, and whole IOG GHC Engineering team for the joint effort of releasing the JS backend. Awesome work!</p>

      <nav>
        <div>
          <a href="https://blog.haskell.org/stability-working-group/">&#8249; Introducing the Haskell Foundation Stability Working Group</a>
        </div>
        <div>
          <a href="https://blog.haskell.org/ghc-9-12-cabal-3-14/"> GHC 9.12 &amp; Cabal 3.14 releases &#8250;</a>
        </div>
      </nav>
    </article>
  </main>
  <footer>
    <div class="c">
      <nav class="tpad"><div><a type="application/atom+xml" href="https://blog.haskell.org/atom.xml" target="_blank" title="The Haskell Programming Language&#x27;s blog Atom Feed"><i type="Button" class="svg rss" title="The Haskell Programming Language&#x27;s blog Atom Feed"></i></a><a href="https://fosstodon.org/@haskell" target="_blank" title="Mastodon" rel="me"><i type="Button" class="svg mastodon" title="Mastodon"></i></a><a href="https://twitter.com/haskellOrg/" target="_blank" title="Twitter"><i type="Button" class="svg twitter" title="Twitter"></i></a><a href="https://github.com/haskell&#x2F;blog.haskell.org/" target="_blank" title="Github"><i type="Button" class="svg github" title="Github"></i></a></div></nav>
      <p class="s80"> &copy; <span id="year">2025</span> The Haskell Programming Language's blog</p>
      <p class="s80">Powered by <a href="https://www.getzola.org/" target="_blank">Zola</a> & <a href="https://github.com/jieiku/abridge/" target="_blank">Abridge</a></p>
    </div>
  </footer><span class="topout">
<span class="topleft"> </span><a href="#" class="top" title="Back to Top"><i class="svgs svgh angu"></i></a>
</span>
</body>
</html>
